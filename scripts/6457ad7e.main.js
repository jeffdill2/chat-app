function Message(a){switch(!0){case!("string"==typeof a):throw new Error("The message may only be in string format!");case a.length<=0:throw new Error("The message must have some content to it!")}this.user=objUser.getInitials(),this.message=a,this.time=Date.now(),this.meta="",this.appID="ChatAtcha"}function User(){this.setInitials=function(a){switch(!0){case!("string"==typeof a):throw alert("You must put in your initials (first name & last name) before logging in to chat..."),new Error("Initials may only be in string format!");case 2!==a.length:throw alert("You must put in your initials (first name & last name) before logging in to chat..."),new Error("Initials may only be two characters!")}this.initials=a.toUpperCase()},this.getInitials=function(){return this.initials}}function renderMessages(a){$("#messages-container").append(messagesTemplate(a))}function messageLoader(){var a;retrieveData(strChatMessagesURL).done(function(b){b.forEach(function(b){verifyMessages(b)&&(b.time=moment(parseInt(b.time)).format("MMMM Do YYYY, hh:mm a"),renderMessages(b)),a=b._id})}),window.scrollTo(0,document.body.scrollHeight),setInterval(function(){var b=!1;retrieveData(strChatMessagesURL).done(function(c){c.forEach(function(c){b&&(verifyMessages(c)&&(c.time=moment(parseInt(c.time)).format("MMMM Do YYYY, hh:mm a"),renderMessages(c)),a=c._id),b||c._id!==a||(b=!0)})}),bolAutoRefresh()&&window.scrollTo(0,document.body.scrollHeight)},100)}function retrieveData(a){return $.getJSON(a).done(function(a){return a.reverse()})}function verifyMessages(a){switch(!0){case"undefined"==typeof a.time:return!1;case"undefined"==typeof a.message:return!1;case"undefined"==typeof a.user:return!1;case"undefined"==typeof a.appID:return!1;default:return!0}}function postMessage(a){$.post(strChatMessagesURL,a)}function bolAutoRefresh(){return $("#auto-scroll").prop("checked")?!0:!1}$(document).ready(function(){$("#message-input-box").prop("disabled",!0),$("#send-button").prop("disabled",!0),$("#auto-scroll").prop("checked",!0),$("#user-initials-box").focus()});var strChatMessagesURL="http://tiny-pizza-server.herokuapp.com/collections/chat-messages/",objUser=new User,messagesTemplate=_.template($("#messages-template").text());$("#message-input-box").keypress(function(a){"13"==a.keyCode&&(a.preventDefault(),$("#send-button").trigger("click"))}),$("#user-initials-box").keypress(function(a){"13"==a.keyCode&&(a.preventDefault(),$("#login-button").trigger("click"))}),$("#login-button").click(function(){objUser.setInitials($("#user-initials-box").val()),objUser&&($("#message-input-box").prop("disabled",!1),$("#send-button").prop("disabled",!1),$("#login-box").fadeOut("slow",function(){$("#login-box").remove()}),$("#message-input-box").focus(),messageLoader())}),$("#send-button").click(function(){var a=new Message($("#message-input-box").val());postMessage(a),$("#message-input-box").val("")});